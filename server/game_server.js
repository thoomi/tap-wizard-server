////////////////////////////////////////////////////////////////////////////////
/// Set a globally available EventBus object
/// This object provides a way for the modules to communicate with each other
////////////////////////////////////////////////////////////////////////////////
var EventBus = require('./core/core_eventbus.js');
global.EventBus = new EventBus();


////////////////////////////////////////////////////////////////////////////////
/// Dependencies
////////////////////////////////////////////////////////////////////////////////
var LOGIC  = LOGIC || {};
LOGIC.Main = require('./logic/logic_main.js');


////////////////////////////////////////////////////////////////////////////////
/// Module exports
/// Declares the name of the object which will be available through the 
/// require() function
////////////////////////////////////////////////////////////////////////////////
module.exports = exports = GameServer; 


////////////////////////////////////////////////////////////////////////////////
/// \fn GameServer()
///
/// \brief The representation of the game sever
////////////////////////////////////////////////////////////////////////////////
function GameServer () {

    ////////////////////////////////////////////////////////////////////////////////
    /// \fn onStartup()
    ///
    /// \brief Sets up and initializes the server
    ////////////////////////////////////////////////////////////////////////////////
    this.onStartup = function() {
        LOGIC.Main.onStartup();
    };


    ////////////////////////////////////////////////////////////////////////////////
    /// \fn onRun()
    ///
    /// \brief "main" function of the server
    ////////////////////////////////////////////////////////////////////////////////
    this.onRun = function() {
        LOGIC.Main.onRun();

        global.EventBus.dispatch('open_new_game');
    };


    ////////////////////////////////////////////////////////////////////////////////
    /// \fn onShutdown()
    ///
    /// \brief Gracefully shutdown of the server
    ////////////////////////////////////////////////////////////////////////////////
    this.onShutdown = function() {
        LOGIC.Main.onShutdown();
    };
}